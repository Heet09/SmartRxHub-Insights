fix: Re-implement robust error handling in API tests